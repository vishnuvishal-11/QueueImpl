<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Converter.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">redis-project</a> &gt; <a href="index.source.html" class="el_package">com.example.RedisProject.model</a> &gt; <span class="el_source">Converter.java</span></div><h1>Converter.java</h1><pre class="source lang-java linenums">package com.example.RedisProject.model;
import lombok.NoArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.validator.GenericValidator;
import org.springframework.stereotype.Component;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.List;
import java.util.Objects;
import java.util.stream.Collectors;

@Component(&quot;convert&quot;)
<span class="fc" id="L15">@Slf4j</span>
<span class="fc" id="L16">@NoArgsConstructor</span>
public class Converter {
    public UserRequestDto entityToDto(UserRequest userRequest) throws ParseException {
<span class="nc" id="L19">        String[] arrOfStr = userRequest.getUserName().split(&quot;_&quot;);</span>
<span class="nc" id="L20">        SimpleDateFormat sdf = new SimpleDateFormat(&quot;dd-MM-yyyy&quot;);</span>
<span class="nc" id="L21">        String strDate=userRequest.getDob().replaceAll(&quot;00:00:00 GMT&quot;,&quot;&quot;);</span>
<span class="nc" id="L22">        Date date = sdf.parse(strDate);</span>
<span class="nc" id="L23">        Calendar cal = Calendar.getInstance();</span>
<span class="nc" id="L24">        cal.setTime(date);</span>
<span class="nc" id="L25">        return new UserRequestDto(userRequest.getId(), arrOfStr[0],arrOfStr[1],</span>
<span class="nc" id="L26">                userRequest.getAge(),cal, userRequest.getLocation());</span>
    }

    public List&lt;UserRequestDto&gt; entityToDto(List&lt;UserRequest&gt; userRequest) {
<span class="nc" id="L30">            return userRequest.stream().map(x-&gt; {</span>
                        try {
<span class="nc" id="L32">                            return this.entityToDto(x);</span>
<span class="nc" id="L33">                        } catch (ParseException e) {</span>
<span class="nc" id="L34">                            throw new RuntimeException(e);</span>
                        }
                    })
<span class="nc" id="L37">                    .collect(Collectors.toList());</span>
    }

    public UserRequest dtoToEntity(UserRequestDto userRequestDto) throws ParseException {
<span class="nc" id="L41">        String date = userRequestDto.getYear() + &quot;-&quot; + userRequestDto.getMonth() + &quot;-&quot; +userRequestDto.getDay();</span>
<span class="nc" id="L42">        SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="nc" id="L43">        Calendar dob = Calendar.getInstance();</span>
<span class="nc" id="L44">        dob.setTime(sdf.parse(date));</span>
<span class="nc" id="L45">        userRequestDto.setDob(dob);</span>
<span class="nc" id="L46">        UserRequestDto userRequestDto1 = new UserRequestDto(userRequestDto.getFirstName(), userRequestDto.getLastName(),</span>
<span class="nc" id="L47">                userRequestDto.getLocation(), userRequestDto.getYear(), userRequestDto.getMonth(), userRequestDto.getDay(),</span>
<span class="nc" id="L48">                Converter.calculateAge(userRequestDto.getDob()),dob);</span>

<span class="nc" id="L50">        String name = userRequestDto.getFirstName().replaceAll(&quot;_&quot;, &quot;-&quot;) + &quot;_&quot; +</span>
<span class="nc" id="L51">                userRequestDto.getLastName().replaceAll(&quot;_&quot;, &quot;-&quot;);</span>

<span class="nc" id="L53">        return new UserRequest(name, userRequestDto1.getAge(), dob.getTime().toString().replaceAll(&quot;00:00:00 GMT&quot;,&quot;&quot;)</span>
<span class="nc" id="L54">               , userRequestDto.getLocation());</span>
    }
    public static int calculateAge(Calendar dob) {
<span class="nc" id="L57">        Calendar today = Calendar.getInstance();</span>
<span class="nc" id="L58">        int curYear = today.get(Calendar.YEAR);</span>
<span class="nc" id="L59">        int dobYear = dob.get(Calendar.YEAR);</span>
<span class="nc" id="L60">        int age = curYear - dobYear;</span>

<span class="nc" id="L62">        int curMonth = today.get(Calendar.MONTH);</span>
<span class="nc" id="L63">        int dobMonth = dob.get(Calendar.MONTH);</span>
<span class="nc bnc" id="L64" title="All 2 branches missed.">        if (dobMonth &gt; curMonth) {</span>
<span class="nc" id="L65">            age--;</span>
<span class="nc bnc" id="L66" title="All 2 branches missed.">        } else if (dobMonth == curMonth) {</span>
<span class="nc" id="L67">            int curDay = today.get(Calendar.DAY_OF_MONTH);</span>
<span class="nc" id="L68">            int dobDay = dob.get(Calendar.DAY_OF_MONTH);</span>
<span class="nc bnc" id="L69" title="All 2 branches missed.">            if (dobDay &gt; curDay) {</span>
<span class="nc" id="L70">                age--;</span>
            }
        }
<span class="nc bnc" id="L73" title="All 6 branches missed.">        if(curYear&lt;dobYear||(curYear==dobYear&amp;&amp;curMonth&lt;dobMonth))</span>
<span class="nc" id="L74">            return 0;</span>

<span class="nc" id="L76">        return age;</span>

    }

    public boolean checkDateAndName(UserRequestDto userRequestDto) throws ParseException {
        String date;
<span class="nc bnc" id="L82" title="All 6 branches missed.">        if(userRequestDto.getYear()%4!=0&amp;&amp;userRequestDto.getMonth()==2&amp;&amp;userRequestDto.getDay()&gt;=29)</span>
        {
<span class="nc" id="L84">            log.error(&quot;not a leap yeAR....&quot;);</span>
<span class="nc" id="L85">            return  false;</span>
        }
<span class="nc bnc" id="L87" title="All 4 branches missed.">        if(userRequestDto.getMonth() &gt;9&amp;&amp;userRequestDto.getDay()&gt;9)</span>
<span class="nc" id="L88">            date = userRequestDto.getYear() + &quot;-&quot; + userRequestDto.getMonth() + &quot;-&quot; +userRequestDto.getDay();</span>
<span class="nc bnc" id="L89" title="All 4 branches missed.">        else if(userRequestDto.getMonth() &lt;9&amp;&amp;userRequestDto.getDay()&gt;9)</span>
<span class="nc" id="L90">            date= userRequestDto.getYear() + &quot;-0&quot; + userRequestDto.getMonth() + &quot;-&quot; +userRequestDto.getDay();</span>
<span class="nc bnc" id="L91" title="All 4 branches missed.">        else if (userRequestDto.getMonth() &gt;9&amp;&amp;userRequestDto.getDay()&lt;9)</span>
<span class="nc" id="L92">            date= userRequestDto.getYear() + &quot;-&quot; + userRequestDto.getMonth() + &quot;-0&quot; +userRequestDto.getDay();</span>
<span class="nc" id="L93">        else  date= userRequestDto.getYear() + &quot;-0&quot; + userRequestDto.getMonth() + &quot;-0&quot; +userRequestDto.getDay();</span>

<span class="nc" id="L95">        SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span>
<span class="nc bnc" id="L96" title="All 2 branches missed.">        return GenericValidator.isDate(sdf.format(sdf.parse(date)), &quot;yyyy-MM-dd&quot;, true)</span>
<span class="nc bnc" id="L97" title="All 4 branches missed.">                &amp;&amp; !Objects.equals(userRequestDto.getFirstName(), &quot;null&quot;)&amp;&amp; !Objects.equals(userRequestDto.getLastName(), &quot;null&quot;);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>